#!/bin/bash

if [ $# -lt 1 ];then
	echo "at least one parameter is required"
fi

export PI_BUILD_SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )/.."
#export PI_BUILD_SCRIPT_DML_FDQN="dml.forge.com"
#export PI_BUILD_SCRIPT_DML_FDQN_SYNC="dml.forge.com"
#export PI_BUILD_SCRIPT_DML_PROTOCOL="https"
export PI_BUILD_SCRIPT_DML_FDQN="${PI_BUILD_SCRIPT_DML_FDQN:-/CI/dml}"
export PI_BUILD_SCRIPT_DML_PROTOCOL="${PI_BUILD_SCRIPT_DML_PROTOCOL:-file}"
export PI_BUILD_SCRIPT_DML_BASE_REPOSITORY="/repository"
export PI_BUILD_SCRIPT_DML_BASE_URL="$PI_BUILD_SCRIPT_DML_PROTOCOL://${PI_BUILD_SCRIPT_DML_FDQN}"
export PI_BUILD_SCRIPT_DML_BASE_URL_SYNC="$PI_BUILD_SCRIPT_DML_PROTOCOL://${PI_BUILD_SCRIPT_DML_FDQN_SYNC}"
export PI_BUILD_SCRIPT_DML_REPOSITORY_URL="${PI_BUILD_SCRIPT_DML_BASE_URL}${PI_BUILD_SCRIPT_DML_BASE_REPOSITORY}"
export PI_BUILD_SCRIPT_DML_REPOSITORY_URL_SYNC="${PI_BUILD_SCRIPT_DML_BASE_URL_SYNC}${PI_BUILD_SCRIPT_DML_BASE_REPOSITORY}"
export PI_BUILD_SCRIPT_DEFAULT_PLATEFORME_BASE_REPO="$PI_BUILD_SCRIPT_DML_REPOSITORY_URL/deployment-plateforme/"
export PI_BUILD_SCRIPT_DEFAULT_PLATEFORME_BASE_REPO_SYNC="$PI_BUILD_SCRIPT_DML_REPOSITORY_URL_SYNC/deployment-plateforme/"

export SYNC_ENABLED=0

if [ ! -f "$PI_BUILD_SCRIPT_DIR/bin/$1.sh" ]; then
	echo "$1 is not a valid command"
	exit 1;
fi

$PI_BUILD_SCRIPT_DIR/bin/$1.sh "${@:2}"
